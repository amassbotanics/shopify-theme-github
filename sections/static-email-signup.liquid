{% assign image = section.settings.image %}
<section class="email-signup__section-wrap">
    <div class="email-signup__image-wrap">
        <div class="email-signup__image-inner-wrap">
            {%
                render 'rimg'
                img: image,
                alt: image.alt,
                size: '300x300',
                lazy: true
            %}
        </div>
    </div>
    <div class="email-signup__content-wrap">
        <div class="email-signup__heading-wrap">
            <h2>{{ section.settings.heading }}</h2>
            <p class="email-signup__subheading">{{ section.settings.subheading }}</p>
        </div>
        <form class="email-signup__form" action="" id="birthday_form">
            <label class="section-strong email-signup__form-label" for="id_$first_name">First Name</label>
            <input
                class="email-signup__form-field"
                type="text"
                placeholder="First name"
                name="$first_name"
                id="id_$first_name"
            >
            <label class="section-strong email-signup__form-label" for="id_$last_name">Last Name</label>
            <input
                class="email-signup__form-field"
                type="text"
                placeholder="Last name"
                name="$last_name"
                id="id_$last_name"
            >
            <label class="section-strong email-signup__form-label" for="id_zip_code">Zip Code</label>
            <input
                class="email-signup__form-field email-signup__form-field--short"
                type="text"
                placeholder="Zip Code"
                name="zip_code"
                id="id_zip_code"
            >
            <h3 class="email-signup__form-birthday-heading"> When is your birthday? </h3>
            <div class="email-signup__form-birthday-wrap">
                <div class="email-signup__form-birthday-field-wrap">
                    <label class="section-strong email-signup__form-label" for="Birthday_month">Month</label>
                    <div class="email-signup__form-field-select-wrap">
                        <select
                        required
                        class="email-signup__form-field email-signup__form-field-select"
                        name="Birthday_month"
                        >
                            <option value="" disabled selected hidden>Month</option>
                            <option value="01">January</option>
                            <option value="02">February</option>
                            <option value="03">March</option>
                            <option value="04">April</option>
                            <option value="05">May</option>
                            <option value="06">June</option>
                            <option value="07">July</option>
                            <option value="08">August</option>
                            <option value="09">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <div class="arrow-drop" >
                            {% render 'icon' with 'down-arrow'%}
                        </div>
                    </div>
                </div>
                <div class="email-signup__form-birthday-field-wrap">
                    <label class="section-strong email-signup__form-label" for="Birthday_day">Day</label>
                    <div class="email-signup__form-field-select-wrap">
                        <select
                        required
                        class="email-signup__form-field email-signup__form-field-select"
                        name="Birthday_day"
                        >
                            <option value="" disabled selected hidden>Day</option>
                            {% for day in (1..31) %}
                                <option value="{{day}}">{{ day }}</option>
                            {% endfor %}
                        </select>
                        <div class="arrow-drop" >
                            {% render 'icon' with 'down-arrow'%}
                        </div>
                    </div>
                </div>
                <div class="email-signup__form-birthday-field-wrap">
                    <label class="section-strong email-signup__form-label" for="Birthday_year">Year</label>
                    <div class="email-signup__form-field-select-wrap">
                        <select
                        required
                        class="email-signup__form-field email-signup__form-field-select"
                        name="Birthday_year"
                        >
                            <option value="" disabled selected hidden>Year</option>
                            {% assign currentYear = "now" | date: "%Y" %}
                            {% assign firstYear =  currentYear | minus: 100 %}
                            {% assign yearArray =  (firstYear..currentYear) %}
                            {% for year in yearArray reversed %}
                                <option value="{{year}}">{{ year }}</option>
                            {% endfor %}
                        </select>
                        <div class="arrow-drop" >
                            {% render 'icon' with 'down-arrow'%}
                        </div>
                    </div>
                </div>
            </div>
            <input class="email-signup__form-submit section-strong" type="submit" value="{{ 'general.submit' | t }}">
            <p class="alert-message success">{{ 'layout.footer.success' | t }}</p>
        </form>
    </div>
</section>

<script>
    function handleBirthdaySubmit(e) {
        e.preventDefault();
        var month = $('select[name="Birthday_month"]').val();
        var day = $('select[name="Birthday_day"]').val();
        var year = $('select[name="Birthday_year"]').val();
        var firstName = $('input[name="$first_name"]').val();
        var lastName = $('input[name="$last_name"]').val();
        var zipCode = $('input[name="zip_code"]').val();

        _learnq.push(['identify',
        {
            'Birthday' : month+"/"+day+"/"+year,
            'Zip Code' : zipCode,
            '$first_name' : firstName,
            '$last_name' : lastName
        }]);
        $('.email-signup__form').addClass('newsletter-submitted');
        $('#birthday_form').find('input').val('');
        $('#birthday_form').find('select').val('');
        $('.email-signup__form-submit').hide();
    }
    window.addEventListener('load', function () {
        $('#birthday_form').on('submit', handleBirthdaySubmit);
    });
</script>

{% schema %}
{
    "name": "Email Signup Form",
    "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Subheading"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
    ]
}
{% endschema %}

